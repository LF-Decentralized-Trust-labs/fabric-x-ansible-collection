#
# Copyright IBM Corp. All Rights Reserved.
#
# SPDX-License-Identifier: Apache-2.0
#

- name: Check that the Grafana dashboard path is defined
  ansible.builtin.fail:
    msg: "No Grafana dashboard path has been defined, but required to build the binary. Set it via 'grafana_dashboard_path'."
  when: grafana_dashboard_path is not defined

- name: Ensure Grafana config directory exists
  ansible.builtin.file:
    path: "{{ grafana_remote_config_dir }}/dashboards"
    state: directory
    mode: "0o755"

- name: Transfer Grafana Dashboard
  ansible.builtin.copy:
    src: "{{ grafana_dashboard_path }}"
    dest: "{{ grafana_remote_config_dir }}/dashboards/{{ grafana_dashboard_file }}"
    mode: "0o640"
