#
# Copyright IBM Corp. All Rights Reserved.
#
# SPDX-License-Identifier: Apache-2.0
#

# ===========================================================
# OpenSSL configuration template for CSR 
# (Certificate Signing Request)
# ===========================================================

# ----- Request Settings -----
# Controls how the certificate request is generated.
[ req ]
# Section defining subject fields
distinguished_name = dn
# X.509 v3 extensions applied to the cert
x509_extensions = v3_req
# Disable interactive input
prompt = no
# Message digest algorithm
default_md = {{ openssl_default_md }}

# ----- Distinguished Name (DN) -----
# These identify the subject (entity) of the certificate.
[ dn ]
# Country code
C  = {{ openssl_country }}
# State or province
ST = {{ openssl_state }}
{% if openssl_locality is defined %}
# City or locality
L  = {{ openssl_locality }}
{% endif %}
# Common Name
CN = {{ openssl_common_name }}
# Organization name
O  = {{ openssl_organization }}
{% if openssl_organizational_unit is defined %}
# Organizational Unit
OU = {{ openssl_organizational_unit }}
{% endif %}

# ----- X.509 v3 Extensions -----
# Defines extensions such as SANs, key usage, and constraints.
[ v3_req ]
# Subject Alternative Names
# Required for TLS: browsers and clients ignore CN for hostname validation.
{% if openssl_san_entries is defined and openssl_san_entries | length > 0 %}
subjectAltName = {{ openssl_san_entries | join(',') }}
{% endif %}
# Basic constraints: indicates whether this is a CA certificate
# For leaf certificates (typical TLS certs), this should be "CA:false"
basicConstraints = {{ openssl_basic_constraints }}
# Key usage defines how the key can be used.
# For TLS, "digitalSignature" (handshake) and "keyEncipherment" (key exchange)
# are standard. You can adjust based on cert type.
keyUsage = {{ openssl_key_usage }}
# Extended key usage refines purpose: server/client authentication, code signing, etc.
# For TLS, "serverAuth" and "clientAuth" are typical.
extendedKeyUsage = {{ openssl_extended_key_usage }}